# par.dat <- params[[20]]. no coexistence
fct.1 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(5,5),
pars= par.dat, gens=t.num,1)) %>%
mutate(total = Ni + Nj)
fct.4 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(5,5),
pars= par.dat, gens=t.num,4)) %>%
mutate(total = Ni + Nj)
testsmall <- t(as.matrix(test[c(10:100),c("Ni","Nj")]))
dim(testsmall)
abxtime4.1 <- fct.4 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() + ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind() + labs(title="Function 4")
abxtime4.2 <-fct.4[c(10:100),] %>% gather(Ni, Nj, key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() +ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
abxtime1.1 <- fct.1 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() +
scale_colour_colorblind() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_fill_colorblind() + labs(title="Function 1")
abxtime1.2 <- fct.1[c(10:100),] %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
ggarrange(abxtime1.1,abxtime1.2,
abxtime4.1,abxtime4.2,align = c("h"),
common.legend = T, ncol= 2, nrow=2, widths=c(3,1))
par.dat <- params[[20]]
t.num = 100
# par.dat <- params[[20]]. no coexistence
fct.1 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(100,100),
pars= par.dat, gens=t.num,1)) %>%
mutate(total = Ni + Nj)
fct.4 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(100,100),
pars= par.dat, gens=t.num,4)) %>%
mutate(total = Ni + Nj)
testsmall <- t(as.matrix(test[c(10:100),c("Ni","Nj")]))
dim(testsmall)
abxtime4.1 <- fct.4 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() + ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind() + labs(title="Function 4")
abxtime4.2 <-fct.4[c(10:100),] %>% gather(Ni, Nj, key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() +ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
abxtime1.1 <- fct.1 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() +
scale_colour_colorblind() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_fill_colorblind() + labs(title="Function 1")
abxtime1.2 <- fct.1[c(10:100),] %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
ggarrange(abxtime1.1,abxtime1.2,
abxtime4.1,abxtime4.2,align = c("h"),
common.legend = T, ncol= 2, nrow=2, widths=c(3,1))
par.dat <- params[[20]]
t.num = 100
# par.dat <- params[[20]]. no coexistence
fct.1 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(10,10),
pars= par.dat, gens=t.num,1)) %>%
mutate(total = Ni + Nj)
fct.4 <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(10,10),
pars= par.dat, gens=t.num,4)) %>%
mutate(total = Ni + Nj)
testsmall <- t(as.matrix(test[c(10:100),c("Ni","Nj")]))
dim(testsmall)
abxtime4.1 <- fct.4 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() + ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind() + labs(title="Function 4")
abxtime4.2 <-fct.4[c(10:100),] %>% gather(Ni, Nj, key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() +ylim(c(0,max(fct.4$Ni,fct.4$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
abxtime1.1 <- fct.1 %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=time)) + #geom_point() +
geom_path(aes(y= abundance,color=species)) +
geom_smooth(aes(y=abundance,color=species,fill=species),alpha=0.1,size=0.5, linetype="dashed") +
theme_bw() +
scale_colour_colorblind() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_fill_colorblind() + labs(title="Function 1")
abxtime1.2 <- fct.1[c(10:100),] %>% gather(Ni, Nj,  key=species, value=abundance) %>%
ggplot(aes(y=abundance, x=..scaled..,color=species)) + geom_density() +
theme_bw() + ylim(c(0,max(fct.1$Ni,fct.1$Nj))) +
scale_colour_colorblind() +
scale_fill_colorblind()
ggarrange(abxtime1.1,abxtime1.2,
abxtime4.1,abxtime4.2,align = c("h"),
common.legend = T, ncol= 2, nrow=2, widths=c(3,1))
function.int=4
par.dat <- params[[34]]
t.num = 100
# par.dat <- params[[20]]. no coexistence
test <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  c(10,10),
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
testsmall <- test[c(10:100),c("Ni","Nj")]
var(testsmall$Ni)
median(testsmall$Ni)
max(testsmall$Ni)
min(testsmall$Ni)
t.num = 200
init <- c(10,10)
summary.df.abundance <- NULL
for (i in 1:2000){
par.dat <- params[[i]]
for(function.int in c(1:4)){
df.sum <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  init,
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
df.sum.small = df.sum[c(10:t.num),]
summary.df.abundance.i<- data.frame(sim = i ,
function.int = function.int,
species = c("Ni","Nj"),
mean=c(mean(df.sum.small$Ni),mean(df.sum.small$Nj)),
median = c(median(df.sum.small$Ni),median(df.sum.small$Nj)),
var.Ni = c(var(df.sum.small$Ni),var(df.sum.small$Nj)),
upperbound = c(max(df.sum.small$Ni) - median(df.sum.small$Ni),
max(df.sum.small$Nj) - median(df.sum.small$Nj) ),
lowerbound =c(median(df.sum.small$Ni) - min(df.sum.small$Ni),
median(df.sum.small$Nj) - min(df.sum.small$Nj)))
summary.df.abundance <- bind_row(summary.df.abundance,summary.df.abundance.i)
}
}
for (i in 1:2000){
par.dat <- params[[i]]
for(function.int in c(1:4)){
df.sum <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  init,
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
df.sum.small = df.sum[c(10:t.num),]
summary.df.abundance.i<- data.frame(sim = i ,
function.int = function.int,
species = c("Ni","Nj"),
mean=c(mean(df.sum.small$Ni),mean(df.sum.small$Nj)),
median = c(median(df.sum.small$Ni),median(df.sum.small$Nj)),
var.Ni = c(var(df.sum.small$Ni),var(df.sum.small$Nj)),
upperbound = c(max(df.sum.small$Ni) - median(df.sum.small$Ni),
max(df.sum.small$Nj) - median(df.sum.small$Nj) ),
lowerbound =c(median(df.sum.small$Ni) - min(df.sum.small$Ni),
median(df.sum.small$Nj) - min(df.sum.small$Nj)))
summary.df.abundance <- bind_rows(summary.df.abundance,summary.df.abundance.i)
}
}
i
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") +
ggplot(aes(x=summary, y= value, color= summary)) + geom_boxplot()+
facet_grid(function.int~species)
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, color= summary)) + geom_boxplot()+
facet_grid(function.int~species)
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, color= summary)) + geom_boxplot()+
facet_grid(function.int~species) + ylim(0,100)
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, color= summary)) + geom_boxplot()+
facet_grid(function.int~species) + ylim(0,10)
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, fill= summary)) + geom_boxplot()+
facet_grid(function.int~species) + ylim(0,10) + them_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, fill= summary)) + geom_boxplot()+
facet_grid(function.int~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, fill= function.int)) + geom_boxplot()+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, fill= function.int, group = function.int)) + geom_boxplot()+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value, fill= function.int)) +
geom_boxplot(aes(group = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= value)) +
geom_boxplot(aes(group = as.factor(function.int),
fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=summary, y= as.factor(value))) +
geom_boxplot(aes(group = as.factor(function.int),
fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(group = as.factor(function.int),
fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance <- scale(  summary.df.abundance)
summary.df.abundance <- lapply(summary.df.abundance,scale)
stand.variable <- c("mean","median","var.Ni","upperbound","lowerbound")
summary.df.abundance <- lapply(summary.df.abundance[,stand.variable],
scale)
summary.df.abundance %>%
gather(mean,median,var.Ni,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
str(summary.df.abundance)
summary.df.abundance <- lapply(summary.df.abundance[,stand.variable],
scale) %>%
as.data.frame()
summary.df.abundance <- NULL
for (i in 1:1000){
par.dat <- params[[i]]
for(function.int in c(1:4)){
df.sum <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  init,
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
df.sum.small = df.sum[c(10:t.num),]
summary.df.abundance.i<- data.frame(sim = i ,
function.int = function.int,
species = c("Ni","Nj"),
mean=c(mean(df.sum.small$Ni),mean(df.sum.small$Nj)),
median = c(median(df.sum.small$Ni),median(df.sum.small$Nj)),
var = c(var(df.sum.small$Ni),var(df.sum.small$Nj)),
upperbound = c(max(df.sum.small$Ni) - median(df.sum.small$Ni),
max(df.sum.small$Nj) - median(df.sum.small$Nj) ),
lowerbound =c(median(df.sum.small$Ni) - min(df.sum.small$Ni),
median(df.sum.small$Nj) - min(df.sum.small$Nj)))
summary.df.abundance <- bind_rows(summary.df.abundance,summary.df.abundance.i)
}
}
summary.df.abundance %>%
lapply(summary.df.abundance[,stand.variable],scale) %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance %>%
lapply(stand.variable,scale) %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
stand.variable
summary.df.abundance[,stand.variable] <- lapply(summary.df.abundance[,stand.variable],scale)
stand.variable
stand.variable <- c("mean","median","var","upperbound","lowerbound")
summary.df.abundance[,stand.variable] <- lapply(summary.df.abundance[,stand.variable],scale)
summary.df.abundance %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + ylim(0,10) + theme_bw() +
scale_fill_colorblind()
head(summary.df.abundance)
summary.df.abundance %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() +
scale_fill_colorblind()
t.num = 200
init <- c(10,10)
summary.df.abundance <- NULL
for (i in 1:1000){
par.dat <- params[[i]]
for(function.int in c(1:4)){
df.sum <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  init,
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
df.sum.small = df.sum[c(10:t.num),]
summary.df.abundance.i<- data.frame(sim = i ,
function.int = function.int,
species = c("Ni","Nj"),
mean=c(mean(df.sum.small$Ni),mean(df.sum.small$Nj)),
median = c(median(df.sum.small$Ni),median(df.sum.small$Nj)),
var = c(var(df.sum.small$Ni),var(df.sum.small$Nj)),
upperbound = c(max(df.sum.small$Ni) - median(df.sum.small$Ni),
max(df.sum.small$Nj) - median(df.sum.small$Nj) ),
lowerbound =c(median(df.sum.small$Ni) - min(df.sum.small$Ni),
median(df.sum.small$Nj) - min(df.sum.small$Nj)))
summary.df.abundance <- bind_rows(summary.df.abundance,summary.df.abundance.i)
}
}
head(  summary.df.abundance)
head(lapply(summary.df.abundance[,stand.variable],scale))
summary.df.abundance2 <- summary.df.abundance
summary.df.abundance2[,stand.variable] <- lapply(summary.df.abundance2[,stand.variable],scale)
head(summary.df.abundance2)
summary(summary.df.abundance2)
summary(summary.df.abundance)
summary.df.abundance2[,stand.variable] <- summary.df.abundance %>%
group_by(function.int) %>%
scale(stand.variable)
summary.df.abundance2 <- summary.df.abundance %>%
group_by(function.int) %>%
scale(stand.variable)
summary.df.abundance2 <- summary.df.abundance %>%
group_by(function.int) %>%
mutate(mean= scale(mean), median=scale(median),
var= scale(var), upperbound=scale(upperbound), upperbound=scale(lowerbound))
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_violin(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
summary.df.abundance2 <- summary.df.abundance %>%
group_by(function.int) %>%
mutate(mean= scale(mean), median=scale(median),
var= scale(var), upperbound=scale(upperbound), upperbound=scale(lowerbound)) %>%
ungroup()
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
summary.df.abundance2 <- summary.df.abundance %>%
group_by(function.int,species) %>%
mutate(mean= scale(mean), median=scale(median),
var= scale(var), upperbound=scale(upperbound), upperbound=scale(lowerbound)) %>%
ungroup()
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
summary.df.abundance2 <- summary.df.abundance %>%
group_by(species) %>%
mutate(mean= scale(mean), median=scale(median),
var= scale(var), upperbound=scale(upperbound), upperbound=scale(lowerbound)) %>%
ungroup()
summary.df.abundance2 %>%
as.data.frame() %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(summary), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(.~species) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
head(summary.df.abundance2)
summary.df.abundance2 <- summary.df.abundance %>%
group_by(species) %>%
mutate(mean= scale(mean), median=scale(median),
var= scale(var), upperbound=scale(upperbound), upperbound=scale(lowerbound)) %>%
ungroup() %>%
as.data.frame()
head(summary.df.abundance2)
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~.) + theme_bw() + ylim(-10,10) +
scale_fill_colorblind()
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~.) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = free) + theme_bw() +
scale_fill_colorblind()
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = "free") + theme_bw() +
scale_fill_colorblind()
head(summary.df.abundance2)
head(summary.df.abundance)
view(head(summary.df.abundance))
view(summary.df.abundance)
std
sd(df.sum.small$Ni)
sd(df.sum.small$Nj)
t.num = 200
init <- c(10,10)
summary.df.abundance <- NULL
for (i in 1:1000){
par.dat <- params[[i]]
for(function.int in c(1:4)){
df.sum <- data.frame(time=c(0:t.num),
Ricker_solution_ODE(state =  init,
pars= par.dat, gens=t.num,function.int)) %>%
mutate(total = Ni + Nj)
df.sum.small = df.sum[c(10:t.num),]
summary.df.abundance.i<- data.frame(sim = i ,
function.int = function.int,
species = c("Ni","Nj"),
mean=c(mean(df.sum.small$Ni),mean(df.sum.small$Nj)),
median = c(median(df.sum.small$Ni),median(df.sum.small$Nj)),
var = c(sd(df.sum.small$Ni),sd(df.sum.small$Nj)),
upperbound = c(max(df.sum.small$Ni) - median(df.sum.small$Ni),
max(df.sum.small$Nj) - median(df.sum.small$Nj) ),
lowerbound =c(median(df.sum.small$Ni) - min(df.sum.small$Ni),
median(df.sum.small$Nj) - min(df.sum.small$Nj)))
summary.df.abundance <- bind_rows(summary.df.abundance,summary.df.abundance.i)
}
}
summary( summary.df.abundance)
summary.df.abundance2 <- summary.df.abundance %>%
group_by(species) %>%
mutate(mean= scale(mean), upperbound=scale(upperbound)) %>%
ungroup() %>%
as.data.frame()
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = "free") + theme_bw() +
scale_fill_colorblind()
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = "free") + theme_bw() +
scale_fill_colorblind() + xlim(0,10)
summary.df.abundance2  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = "free") + theme_bw() +
scale_fill_colorblind() + ylim(0,10)
summary.df.abundance  %>%
gather(mean,median,var,upperbound,lowerbound ,key="summary",value="value") %>%
ggplot(aes(x=as.factor(species), y= value)) +
geom_boxplot(aes(fill = as.factor(function.int)))+
facet_grid(summary~., scales = "free") + theme_bw() +
scale_fill_colorblind() + ylim(0,10)
ggsave(last_plot(),
file = "figures/summary.abundances.pdf")
